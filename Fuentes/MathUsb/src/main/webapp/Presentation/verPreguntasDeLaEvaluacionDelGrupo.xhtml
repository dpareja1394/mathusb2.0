<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</h:head>

<h:body>
	<ui:composition template="/WEB-INF/facelets/template.xhtml">
		<ui:define name="body">
			<f:view>
				<script type="text/javascript">
					function justNumbers(e) {
						var keynum = window.event ? window.event.keyCode
								: e.which;
						if ((keynum == 8) || (keynum == 46) || (keynum == 44))
							return true;

						return /\d/.test(String.fromCharCode(keynum));
					}
					//onkeypress="return justNumbers(event);" cambiada
					PrimeFaces.locales['es'] = {
						closeText : 'Cerrar',
						prevText : 'Anterior',
						nextText : 'Siguiente',
						monthNames : [ 'Enero', 'Febrero', 'Marzo', 'Abril',
								'Mayo', 'Junio', 'Julio', 'Agosto',
								'Septiembre', 'Octubre', 'Noviembre',
								'Diciembre' ],
						monthNamesShort : [ 'Ene', 'Feb', 'Mar', 'Abr', 'May',
								'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic' ],
						dayNames : [ 'Domingo', 'Lunes', 'Martes', 'Miércoles',
								'Jueves', 'Viernes', 'Sábado' ],
						dayNamesShort : [ 'Dom', 'Lun', 'Mar', 'Mie', 'Jue',
								'Vie', 'Sab' ],
						dayNamesMin : [ 'D', 'L', 'M', 'M', 'J', 'V', 'S' ],
						weekHeader : 'Semana',
						firstDay : 1,
						isRTL : false,
						showMonthAfterYear : false,
						yearSuffix : '',
						timeOnlyTitle : 'Sólo hora',
						timeText : 'Tiempo',
						hourText : 'Hora',
						minuteText : 'Minuto',
						secondText : 'Segundo',
						currentText : 'Fecha actual',
						ampm : false,
						month : 'Mes',
						week : 'Semana',
						day : 'Día',
						allDayText : 'Todo el día'
					};
					function showStatus() {
						statusDialog.show();
					}

					function hideStatus() {
						statusDialog.hide();
					}
				</script>	
				<script src="#{facesContext.externalContext.request.scheme}://#{facesContext.externalContext.request.serverName}:#{facesContext.externalContext.request.serverPort}#{facesContext.externalContext.request.contextPath}/js/wirisEditor.js"></script>
				<script>
					var editor = [];
					window.onload = function() {
						var z = document.getElementsByClassName('ui-tabs-panels');
						var x = z[0].getElementsByClassName('ui-tabs-panel');
						var y = z[0].getElementsByClassName('ui-panel-content');
						for(var i=0;i!=x.length;i++){
							var tipoRespuesta = x[i].lastChild.innerHTML;
							if(tipoRespuesta=="1"){
								editor[i] = com.wiris.jsEditor.JsEditor.newInstance({'language' : 'es'});
							}
						}
						for(var i=0;i!=x.length;i++){
							var tipoRespuesta = x[i].lastChild.innerHTML;
							if(tipoRespuesta=="1"){
								editor[i].insertInto(y[i]);
							}
						}
					}
					function doGet() {
						document.getElementById('formDialog:txtPregunta').value = editor[0].getMathML();
						document.getElementById('formDialog:txtRespuestaCorrecta').value = editor[1].getMathML();
						document.getElementById('formDialog:txtRespuesta1').value = editor[2].getMathML();
						document.getElementById('formDialog:txtRespuesta2').value = editor[3].getMathML();
						document.getElementById('formDialog:txtRespuesta3').value = editor[4].getMathML();
						//window.onload();
					}
				</script>
				
				<p:ajaxStatus onstart="PF('statusDialog').show()"
					onsuccess="PF('statusDialog').hide()" />
				<p:dialog modal="true" widgetVar="statusDialog" header="Loading"
					draggable="false" closable="false">
					<p:graphicImage
						value="#{facesContext.externalContext.request.scheme}://#{facesContext.externalContext.request.serverName}:#{facesContext.externalContext.request.serverPort}#{facesContext.externalContext.request.contextPath}/images/ajaxloadingbar.gif" />
				</p:dialog>

				<!-- Expired session -->
				<p:idleMonitor onactive="PF('sessionTimeOutDialog').show();"
					timeout="#{session.maxInactiveInterval * 1000}" />
				<p:dialog modal="true" widgetVar="sessionTimeOutDialog"
					header="Expired session" draggable="false" closable="false">
					<h:outputText value="The session is finished" />
					<input id="confirmBackToLogin" type="button" value="Sign in"
						onclick="window.location='#{facesContext.externalContext.requestContextPath}/index.jsp';" />
				</p:dialog>

				<h:form id="formDialog">
					<p:messages id="msg" />
					<p:growl id="men" />
					<p:panel id="panelEvaluacionMostrar" header="Documento">
						
						<h:panelGrid columns="2" id="panelGrid">

							<h:outputLabel value="Asunto: " />
							<p:outputLabel value="#{evaluacionView.asuntoEvaluacion}" />

							<h:outputLabel value="Fecha de Inicio de Publicación: " />
							<p:outputLabel value="#{evaluacionView.fechaInicioEvaluacion}" />


							<h:outputLabel value="Fecha de Finalizacion de Publicación: " />
							<p:outputLabel value="#{evaluacionView.fechaFinEvaluacion}" />


							<h:outputLabel value="Corte: " />
							<p:outputLabel value="#{evaluacionView.corteEvaluacion}" />

						</h:panelGrid>
					</p:panel>					
					<p:panel id="panelPreguntasEvaluacion"
						header="Preguntas que contiene la evaluacion"
						style="width:99%">
						<p:tabView id="tabs" value="#{evaluacionView.imagenes}" var="tab">
							<p:tab title="#{tab.titulo}">
								<p:inputText style="display:none"></p:inputText>
								<h:outputLabel value="Tema: "/>
								<p:outputLabel value="#{tab.tema}" /><br/>
								<h:outputLabel value="Pregunta: "/>
								<p:graphicImage value="#{tab.rutaPregunta}" stream="true" cache="false"/>
								<p:panel>
									<p:panelGrid columns="1">
										<p:graphicImage value="#{tab.rutaRespuesta1}" stream="true" cache="false"/><br/>
										<p:graphicImage value="#{tab.rutaRespuesta2}" stream="true" cache="false"/><br/>
										<p:graphicImage value="#{tab.rutaRespuesta3}" stream="true" cache="false"/><br/>
										<p:graphicImage value="#{tab.rutaRespuesta4}" stream="true" cache="false"/><br/>
									</p:panelGrid>
								</p:panel>
								<p:outputLabel value="#{tab.tipoRespuesta}" style="display:none"/>
							</p:tab>
						</p:tabView>
					</p:panel>
					<p:panel id="panelBotones">		
						<p:commandButton value="Guardar respuestas" icon="ui-icon-plus"  onclick="doGet()"
						action="#{preguntaView.guardarRespuestas}"
						/>
					</p:panel>		
				</h:form>


			</f:view>
		</ui:define>
	</ui:composition>
</h:body>
</html>
